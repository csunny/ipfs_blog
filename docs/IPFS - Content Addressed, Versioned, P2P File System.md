# Abstract 

星际文件系统(IPFS）是一个p2p分布式文件系统， 其将所有具有相同文件的计算机设备链接到一起。 换句话说，IPFS跟Web非常相似，IPFS可以被看成是一个单集群的BitTorrent系统，对象之间相互通过一个git仓库来访问。 另外IPFS提供了基于内容寻址的块存储模型。通过形成一个序列化的MerKleDAG(一种计算机数据结构)来构建带版本的文件系统，区块链甚至一个永久存在的web服务。IPFS结合了分布式hash表， 块交换的激励机制，以及自证的命名空间。不同于传统的分布式系统IPFS不存在单节点失效问题，节点直接也不需要彼此互信。


# INTRODUCTION

在IPFS之前，人们尝试了各种方式来构建一个全球化的分布式文件系统。有些系统目前已经取得了极大的成功，当然难免有一些走向了失败的命运。在这些学术性的尝试中，AFS取得了广泛的成功，甚至今天任然在被人们所使用。 相比于此，其他的项目就没那么幸运了。在学术界以外，最成功的分布式系统已经实现了文件与音视频资料的分享。比如：Napster、KaZaA、以及BitTorrent。
BitTorrent已经是一个相当大的分布式系统了，支撑着上亿的用户。截止目前，BitTorrent保持着巨大的部署量，每天有数千万个节点的变动。这些应用的用户数量和使用频次都要远远超过学术文件系统。但是这些应用设计并不能作为一个底层的基础设施。 虽然部分系统可以被重用，但尚未出现提供全球化的、低延迟的、分散式的通用文件系统。

或许因为人们满足于HTTP协议的“完美”。目前为止，HTTP是最成功的”分布式文件系统“。HTTP与浏览器双剑合璧之后，具有广泛的科技与社会影响力，几乎是无敌的存在。它已经成为互联网文件传输的标准。尽管如此，它也有自己的弱项，最近这些年发展起来的很多优秀的分布式技术它都没有利用。一方面，不断发展的web基础架构几乎不可能存在，当下的模型主要受限于向后的兼容性以及对其他各方的依赖。另一方面，HTTP出现之后，很多新的协议相继出现，有些协议已经获得了广泛的应用。在这些协议中，缺少对于服务升级的设计，比如：增强当前的HTTP Web，在不影响用户体验的情况下影响新的功能。

由于移动小文件相对廉价，在行业内已经很少使用HTTP了，即使对于那些拥有很多流量的小型组织也是如此。同时对于数据的分发，我们又面临着新的挑战

- 托管和分发petabyte数据集
- 跨组织的计算大数据
- 高容量、高清的实时流媒体传输
- 大规模数据集的版权和链接
- 防止重要文件的丢失

等等。
以上种种可以大概归结为: "海量数据的任意地点访问"。 在关键功能和贷款问题的推动下，我们已经为不同的数据分发协议放弃了HTTP。 下一步，我们的目的是让它们成为Web本身的一部分。


在解决高效的数据分发与版本控制方面，已经有非常成功的数据协作工作流系统被开发出来了。
Git，分布式的源代码版本控制系统，其开发了许多有用的方法来建模以及实现分布式数据操作。
Git工具链提供了多种版本控制的功能，这些都是目前其他大型文件分发系统严重缺失的。
受Git启发的新的解决方案正在兴起，比如Camlistore（个人的文件存储系统)，Dat(数据协作工具链和数据集包管理器)。Git影响了分布式文件系统的设计，因为其内容寻址MerkleDAG数据模型提供了强大的文件分发策略。当然，这种数据结构如何影响高吞吐量定向文件系统的设计，以及它如何升级Web自身值得我们去进一步探索。

本篇内容主要介绍IPFS，一种新颖的点对点版本控制文件系统，旨在协调这些问题。IPFS借鉴了许多过去成功的学习经验， 集成了过去许多优秀的设计理念。IPFS的核心理念是将所有的数据模型都是MerkleDAG的一部分。


# BACKGROUND
此部分回顾了IPFS借鉴的那些成功的点对点系统的重要特性。

## Distributed Hash Tables


### Kademlia DHT

### Coral DSHT

### S/Kademlia DHT


## Block Exchanges —— Bitorrent


## Version Control Systems —— Git

## Self-Certified Filesystems —— SFS


# IPFS DESIGN
IPFS是一个分布式的文件系统，它集合了以前点对点对等网络的成功思想，包括DHTs，BitTorrent，Git，以及SFS。IPFS的贡献在于将经过验证的技术进行简化、发展和链接，将它们整合到了一个系统中，来达到1+1>2的效果。IPFS不仅提供了一个用于编写和部署应用程序的新平台，而且是一个用于内容分发和版本管理的大数据新系统。IPFS是一个自进化的web系统。IPFS是基于点对点对等网络。节点之间相互平台，不存在特权节点。IPFS节点将IPFS对象存储在本地。节点之间相互连接来进行数据传输。数据可以是文件也可以是其他任意的数据结构。IPFS协议可以分为一系列的子协议，它们分别负责不同的功能
- Identities —— 管理节点标识和验证
- NetWork —— 管理与其他节点的连接，使用各种底层网络协议。可配置
- Routing —— 路由信息维护，主要用来进行节点查询以及数据文件定位。默认采用DHT, 但也可以替换。
- Exchange —— 一种新颖的块交换协议(BitSwap), 用于管理有效的块分配。 模仿市场，弱激励数据复制。交易策略可更换。
- Objects —— 基于MerkleDAG的内容寻址不可变对象
- Files —— 受Git启发的版本化分层文件系统
- Naming —— 自我认证的可变命名系统

以上子系统并不是独立的。 它们是集成在一起的，可以混合来使用。之所以分开描述，是为了让从下到上构建协议栈的过程更加清晰易懂。

提示： 以下的数据结构和函数用Go语言语法表示。

## Identities
节点由NodeId标识，NodeId是采用S/Kademlia的静态加密模块创建的公钥加密的Hash值。节点存储其公钥和私钥(使用密码学加密) 用户可以在每次运行节点时自由的设置节点标识，但这样会损失积累的网络优势。节点被激励来保持不变。

## Network

### Note on Peer Addressing

## Routing

## Block Exchange ——  BitSwap Protocol

### BitSwap Credit

### BitSwap Strategy

### BitSwap Ledger


## Object Merkle DAG

## IPNS: Naming and Mutable State

## Using IPFS

# THE FUTURE

# ACKNOWLEDGMENTS
IPFS是许多伟大的想法和系统的结合。正是因为站在巨人的肩膀上，所以它敢于有这样的雄心壮志。感谢David Dalrymple, Joe Zimmerman, and Ali Yahya跟我一起长期讨论伟大的想法。感谢(David, Joe)在MerkleDAG设计中的贡献，David在可回滚哈希块中的贡献，以及(David, Joe)在 s/kademlia sybill protection中的贡献，特别要感谢David Mazieres，感谢他出色的创意。

